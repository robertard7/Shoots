<Window x:Class="Shoots.UI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Shoots" Height="640" Width="860">
  <Window.Resources>
    <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
  </Window.Resources>
  <Grid Margin="24">
    <TabControl>
      <TabItem Header="Execution">
        <Grid Margin="16">
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
          </Grid.RowDefinitions>
          <Border Background="#FFEFF6FF" Padding="12" CornerRadius="4">
            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
              <TextBlock Text="Execution State:" FontWeight="SemiBold" />
              <TextBlock Text="{Binding StateLabel}" Margin="8,0,0,0" />
              <TextBlock Text="Replay Mode" Margin="16,0,0,0"
                         ToolTip="Replay mode is read-only and trace-backed."
                         Visibility="{Binding IsReplayMode, Converter={StaticResource BooleanToVisibilityConverter}}" />
            </StackPanel>
          </Border>
          <StackPanel Grid.Row="1" Margin="0,16,0,0" Orientation="Horizontal" HorizontalAlignment="Left">
            <Button Width="110" Content="Start" Command="{Binding StartCommand}" />
            <Button Width="110" Margin="8,0,0,0" Content="Cancel" Command="{Binding CancelCommand}" />
            <Button Width="140" Margin="8,0,0,0" Content="Refresh Status" Command="{Binding RefreshStatusCommand}" />
          </StackPanel>
          <TextBlock Grid.Row="2" Margin="0,24,0,0" Text="Shoots UI Shell" FontSize="20" FontWeight="SemiBold" />
        </Grid>
      </TabItem>
      <TabItem Header="Environment">
        <Grid Margin="16">
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
          </Grid.RowDefinitions>
          <TextBlock Text="Environment profiles prepare the local sandbox only. This does not affect execution logic." TextWrapping="Wrap" />
          <GroupBox Grid.Row="1" Margin="0,12,0,0" Header="Profile">
            <StackPanel Margin="12">
              <ComboBox ItemsSource="{Binding Profiles}" SelectedItem="{Binding SelectedProfile}" DisplayMemberPath="Name" />
              <TextBlock Margin="0,8,0,0" Text="{Binding SelectedProfileDescription}" TextWrapping="Wrap" />
              <ItemsControl Margin="0,8,0,0" ItemsSource="{Binding EnvironmentCapabilities}">
                <ItemsControl.ItemTemplate>
                  <DataTemplate>
                    <TextBlock Text="{Binding}" />
                  </DataTemplate>
                </ItemsControl.ItemTemplate>
              </ItemsControl>
            </StackPanel>
          </GroupBox>
          <StackPanel Grid.Row="2" Margin="0,12,0,0" Orientation="Horizontal">
            <Button Width="160" Content="Apply Environment" Command="{Binding ApplyEnvironmentCommand}" />
            <TextBlock Margin="12,0,0,0" VerticalAlignment="Center" Text="{Binding EnvironmentAppliedProfileName}" />
          </StackPanel>
          <GroupBox Grid.Row="3" Margin="0,12,0,0" Header="Last Applied">
            <StackPanel Margin="12">
              <TextBlock Text="{Binding EnvironmentAppliedAtUtc}" />
              <ItemsControl Margin="0,8,0,0" ItemsSource="{Binding EnvironmentAppliedCapabilities}">
                <ItemsControl.ItemTemplate>
                  <DataTemplate>
                    <TextBlock Text="{Binding}" />
                  </DataTemplate>
                </ItemsControl.ItemTemplate>
              </ItemsControl>
              <ItemsControl Margin="0,8,0,0" ItemsSource="{Binding EnvironmentCreatedPaths}">
                <ItemsControl.ItemTemplate>
                  <DataTemplate>
                    <TextBlock Text="{Binding}" />
                  </DataTemplate>
                </ItemsControl.ItemTemplate>
              </ItemsControl>
              <TextBlock Margin="0,8,0,0" Text="Restart required to pick up capability changes."
                         Visibility="{Binding RestartRequired, Converter={StaticResource BooleanToVisibilityConverter}}" />
            </StackPanel>
          </GroupBox>
          <StackPanel Grid.Row="4" Margin="0,12,0,0">
            <GroupBox Header="Source Control" Visibility="{Binding HasSourceControl, Converter={StaticResource BooleanToVisibilityConverter}}">
              <TextBlock Margin="12" Text="Source control integration is available when enabled by the environment profile." TextWrapping="Wrap" />
            </GroupBox>
            <GroupBox Margin="0,12,0,0" Header="Artifact Export" Visibility="{Binding HasArtifactExport, Converter={StaticResource BooleanToVisibilityConverter}}">
              <StackPanel Margin="12">
                <TextBlock Text="Artifact export UI is enabled by the environment profile." TextWrapping="Wrap" />
                <Button Width="160" Margin="0,8,0,0" Content="Export Artifacts" />
              </StackPanel>
            </GroupBox>
          </StackPanel>
        </Grid>
      </TabItem>
      <TabItem Header="Database" Visibility="{Binding HasDatabase, Converter={StaticResource BooleanToVisibilityConverter}}">
        <Grid Margin="16">
          <StackPanel>
            <TextBlock Text="Database access is optional and never required for Shoots execution." TextWrapping="Wrap" />
            <GroupBox Margin="0,12,0,0" Header="Configuration">
              <StackPanel Margin="12">
                <TextBlock Text="No database configured." />
              </StackPanel>
            </GroupBox>
          </StackPanel>
        </Grid>
      </TabItem>
    </TabControl>
  </Grid>
</Window>
